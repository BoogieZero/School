   1              	# 1 "D:\\MCU\\H8S\\Asembler H8S\\Workspace_POT\\C_Asm\\start.asm"
   1              	/*------------------------------------------------------------------------
   0              	
   0              	
   0              	
   2              	                                                                       |
   3              	   FILE        : start.asm                                             |
   4              	   DATE        :  Wed, Feb 22, 2012                                    |
   5              	   DESCRIPTION :   Reset Program                                       |
   6              	   CPU TYPE    :    H8S/Other                                          |
   7              	                                                                       |
   8              	   This file is generated by KPIT GNU Project Generator (Ver.4.5).     |
   9              	                                                                       |
  10              	------------------------------------------------------------------------*/
  11              	                        
  12              	
  13              	
  14              	
  15              	;*********************************************************************
  16              	; File: start.asm
  17              	;
  18              	;
  19              	; desc:
  20              	; 
  21              	;  System initialisation routine - entry point for the application.
  22              	;  The stack pointer is initialised, then the hardware initialisation
  23              	;  routine called.  The static data areas are then initialised, before
  24              	;  the main function is executed.  A simple exit funtion is also
  25              	;  supplied
  26              	;
  27              	;*********************************************************************
  28              	#ifdef __H8300H__  
  29              		
  30              	#ifdef __NORMAL_MODE__
  31              		.h8300hn
  32              	#else
  33              		.h8300h
  34              	#endif
  35              		
  36              	#endif	/*_H8300H_ */
  37              		
  38              	#ifdef __H8300S__
  39              		
  40              	#ifdef __NORMAL_MODE__
  41              		.h8300sn
  42              	#else
  43              		.h8300s
  44              	#endif
  45              	
  46              	#endif /* __H8300S__ */
  47              	
  48              	#ifdef __H8300SX__
  49              	
  50              	#ifdef __NORMAL_MODE__
  51              		.h8300sxn
  52              	#else
  53              		.h8300sx
  54              	#endif
  55              	
  56              	#endif /* __H8300SX__ */	
  57              	
  58              		
  59              		.section .text
  60              		.global _start
  61              	
  62              	#ifdef CPPAPP	
  63              	___dso_handle:
  64              		.global ___dso_handle
  65              	#endif	
  66              	
  67              	#if DEBUG	
  68              		.extern _exit
  69              	#endif
  70              	
  71              		.extern _hw_initialise
  72              		.extern _main
  73              	
  74              		.extern _data
  75              		.extern _mdata
  76              		.extern _edata
  77              		.extern _bss
  78              		.extern _ebss
  79              		.extern _stack
  80              	
  81              	_start:
  82              		; initialise the SP for non-vectored code
  83 0000 7A070000 	    mov.l   #_stack,er7
  83      0000
  84              		; call the hardware initialiser
  85 0006 5E000000 	    jsr     @_hw_initialise
  86              	    
  87              		; get the boundaries for the .data section initialisation
  88 000a 7A000000 	    mov.l   #_data,er0
  88      0000
  89 0010 7A010000 	    mov.l   #_edata,er1
  89      0000
  90 0016 7A020000 	    mov.l   #_mdata,er2
  90      0000
  91 001c 1F81     	    cmp.l   er0,er1
  92 001e 4700     		beq     start_1
  93              	start_l:
  94 0020 682B     	    mov.b   @er2,r3l  ;get from src
  95 0022 688B     	    mov.b   r3l,@er0  ;place in dest
  96 0024 0B72     	    inc.l   #1,er2    ;inc src
  97 0026 0B70     	    inc.l   #1,er0    ;inc dest
  98 0028 1F81     	    cmp.l   er0,er1   ;dest == edata?
  99 002a 4600     		bne     start_l
 100              	start_1:
 101              		; zero out bss
 102 002c 7A000000 	    mov.l   #_bss,er0
 102      0000
 103 0032 7A010000 	    mov.l   #_ebss,er1
 103      0000
 104 0038 1F81     	    cmp.l   er0,er1         
 105 003a 4700     		beq     start_3
 106 003c 18AA     		sub.b   r2l,r2l
 107              	start_2:
 108 003e 688A     	    mov.b   r2l,@er0
 109 0040 0B70     	    inc.l   #1,er0
 110 0042 1F81     	    cmp.l   er0,er1
 111 0044 4600     		bne     start_2
 112              	start_3:
 113              	#ifdef CPPAPP	
 114              		;Initialize global constructor	
 115              		jsr	@___main
 116              	#endif
 117              		
 118              		; call the mainline     
 119 0046 5E000000 		jsr     @_main
 120              	
 121              		
 122 004a 0F84     	    mov.l   er0,er4
 123              	    
 124              	    ;call to exit
 125              	#if DEBUG
 126 004c 5E000000 	    jsr     @_exit


==============================================================

Listfile generated by KPIT GNUH8 [ELF]-v11.02 on Thursday, February 23, 2012, 14:00:25

Build options:

-c -x assembler-with-cpp
-ms -ms2600
-I "c:\program files\renesas\hew\tools\kpit cummins\gnuh8-elf\v11.02\h8300-elf\h8300-elf\optlibinc"
-I "c:\program files\renesas\hew\tools\kpit cummins\gnuh8-elf\v11.02\h8300-elf\lib\gcc\h8300-elf\4.5-GNUH8_v11.02\optlibinc"
-D DEBUG
-Wa,-alhdn="D:\MCU\H8S\Asembler H8S\Workspace_POT\C_Asm\Debug\start.lis"
-nostdinc
"D:\MCU\H8S\Asembler H8S\Workspace_POT\C_Asm\start.asm"
-Wa,-gdwarf2
-g
-g2
-o "D:\MCU\H8S\Asembler H8S\Workspace_POT\C_Asm\Debug\start.o"
